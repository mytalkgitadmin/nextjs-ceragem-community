# 🎯 Ceragem Community (FETA) 비즈니스 로직 전체 분석

## 📋 1. 인증 관리 (Authentication)

### 핵심 비즈니스 로직

#### 1.1 로그인/로그아웃 처리

- **로그인 프로세스**: 휴대폰번호 + 비밀번호 → 토큰 발급 → 사용자 정보 저장
- **자동 로그인 유지**: localStorage를 통한 영속적 인증 상태 관리
- **로그아웃 확인**: 사용자 확인 후 로그아웃 처리 및 저장소 정리
- **리턴 URL 관리**: 로그인 후 원래 페이지로 자동 이동

#### 1.2 토큰 관리

- **다중 토큰 시스템**: Access Token, Refresh Token, Session Token 관리
- **자동 토큰 갱신**: 만료 시간 감지 후 자동 갱신 처리
- **중복 갱신 방지**: Promise 캐싱을 통한 동시 갱신 요청 방지
- **토큰 유효성 검사**: 페이지 포커스 시 토큰 상태 재검증

#### 1.3 사용자 프로필 동기화

- **프로필 데이터 로딩**: 인증 후 자동 프로필 정보 조회
- **프로필 변경 감지**: API 응답과 로컬 상태 비교 후 업데이트
- **에러 처리**: 프로필 로딩 실패 시 재시도 로직

#### 1.4 폼 입력 처리

- **전화번호 포맷팅**: 입력 시 자동 하이픈 추가/제거 처리
- **비밀번호 검증**: 공백 제거 및 실시간 유효성 검사
- **에러 메시지 처리**: API 에러 코드별 사용자 친화적 메시지 표시
- **폼 상태 관리**: 입력값 유효성에 따른 제출 버튼 활성화

---

## 📋 2. 친구 관리 (Friend Management)

### 핵심 비즈니스 로직

#### 2.1 친구 상태 관리

- **친구 관계 타입**: NORMAL, FAVORITE, REQUESTED, REQUEST, BLOCK, HIDE, DELETE 상태 관리
- **친구 분류 시스템**: 즐겨찾기, 새 친구, 업데이트된 친구, 요청한 친구, 숨긴 친구, 차단한 친구로 자동 분류
- **친구 정렬**: 이름순 정렬 및 카테고리별 표시

#### 2.2 친구 요청 및 응답

- **친구 요청**: 전화번호 기반 친구 추가 요청
- **친구 수락**: 친구 요청 승인 처리 (그룹 지정 가능)
- **친구 거절**: 친구 요청 거부 처리
- **그룹 관리**: 친구를 특정 그룹에 배정

#### 2.3 친구 상태 변경

- **즐겨찾기 토글**: 친구를 즐겨찾기에 추가/제거
- **친구 숨김/표시**: 친구 목록에서 숨기기/다시 표시
- **친구 차단/차단해제**: 친구와의 모든 상호작용 차단/허용
- **친구 삭제**: 친구 관계 완전 삭제

#### 2.4 친구 검색 및 필터링

- **실시간 검색**: 친구 이름/전화번호 기반 실시간 검색
- **상태별 필터**: 친구 상태별 필터링 기능
- **새 친구 감지**: 새로 추가된 친구 자동 감지 및 표시
- **프로필 업데이트 감지**: 최근 프로필을 업데이트한 친구 표시

#### 2.5 대화 상대 선택

- **다중 선택**: 여러 친구 선택 기능
- **선택 상태 관리**: 선택된 친구들의 상태 추적
- **채팅 시작**: 선택된 친구들과 채팅방 생성

---

## 📋 3. 실시간 채팅 (Chat)

### 핵심 비즈니스 로직

#### 3.1 채널 관리

- **채널 생성**: GROUP, DIRECT, FAMILY, MY, ADMIN 타입별 채널 생성
- **채널 URL 관리**: 현재 활성 채널 URL 상태 관리 (세션 저장)
- **멤버 관리**: 채널 참여자 목록 및 권한 관리

#### 3.2 파일 업로드 및 관리

- **파일 업로드**: 이미지, 동영상, 문서 등 다양한 파일 타입 업로드
- **파일 유효성 검사**: 파일 크기, 확장자, MIME 타입 검증
- **이미지 그룹 업로드**: 여러 이미지 동시 업로드 및 미리보기
- **파일 압축**: 업로드 전 이미지 크기 및 품질 최적화

#### 3.3 파일 검색 시스템

- **검색 필터**: 파일 타입, 확장자, 카테고리별 검색
- **검색어 기반**: 파일명, 내용 기반 검색
- **소유자 필터**: 특정 사용자가 업로드한 파일 검색
- **날짜 범위**: 업로드 날짜 기반 검색

#### 3.4 메시지 처리

- **메시지 암호화**: 메시지 내용 암호화/복호화 처리
- **메시지 유효성 검사**: 메시지 길이, 내용 검증
- **특수 메시지**: 시스템 메시지, 파일 메시지 등 타입별 처리
- **메시지 편집 감지**: 메시지 수정 가능성 판단

#### 3.5 UI 상태 관리

- **채널 서랍**: 채널 정보 서랍 열림/닫힘 상태
- **레이아웃 상태**: 채팅 화면 레이아웃 설정
- **미리보기**: 파일 미리보기 모달 상태 관리

#### 3.6 유틸리티 기능

- **클립보드 복사**: 텍스트/링크 클립보드 복사 기능
- **전화번호 포맷팅**: 전화번호 표시 형식 변환
- **파일 크기 표시**: 바이트 단위를 사용자 친화적 단위로 변환
- **URL 유효성 검사**: URL 형식 및 유효성 검증

---

## 📋 4. 알림 관리 (Notifications)

### 핵심 비즈니스 로직

#### 4.1 알림 조회 및 분류

- **카테고리별 조회**: FRIEND_REQUEST, CHAT, SYSTEM 등 카테고리별 알림 조회
- **알림 목록**: 사용자별 알림 목록 조회 및 표시
- **읽음/미읽음 상태**: 알림 읽음 상태 관리

#### 4.2 알림 상태 변경

- **알림 읽음 처리**: 개별 알림 읽음 상태 변경
- **알림 삭제**: 불필요한 알림 삭제 처리
- **일괄 처리**: 다중 알림 일괄 읽음/삭제 처리

#### 4.3 알림 카운트 관리

- **채팅 미읽음 카운트**: 읽지 않은 채팅 메시지 개수 관리
- **친구 요청 카운트**: 친구 요청 개수 증가/감소 처리
- **Firebase 알림 카운트**: Push 알림 개수 관리
- **전체 카운트 계산**: 모든 알림 타입의 총 개수 자동 계산

#### 4.4 브라우저 알림

- **앱 뱃지**: 브라우저 앱 아이콘 뱃지 표시
- **파비콘 뱃지**: 파비콘에 알림 개수 표시
- **초기 로딩**: 앱 시작 시 알림 개수 초기 로딩

#### 4.5 알림 초기화

- **카운트 리셋**: 특정 조건에서 알림 카운트 초기화
- **스토리지 정리**: 오래된 알림 데이터 정리

---

## 📋 5. 프로필 관리 (Profile)

### 핵심 비즈니스 로직

#### 5.1 프로필 조회

- **개인 프로필**: 사용자 개인 프로필 정보 조회
- **Sendbird 프로필**: 채팅용 프로필 정보 조회 및 동기화
- **다른 사용자 프로필**: 타 사용자 프로필 조회

#### 5.2 프로필 수정

- **텍스트 정보 수정**: 이름, 상태메시지 등 텍스트 정보 수정
- **프로필 이미지 수정**: 이미지 파일 업로드 또는 이모티콘 선택
- **변경사항 감지**: 기존 정보와 비교하여 변경사항 감지

#### 5.3 이미지 처리

- **파일 업로드**: 프로필 이미지 파일 업로드
- **이미지 유효성 검사**: 파일 크기, 형식 검증
- **이모티콘 선택**: 기본 제공 이모티콘으로 프로필 설정
- **이미지 변환**: 원본, 썸네일 등 다양한 크기로 변환

#### 5.4 폼 상태 관리

- **입력 상태**: 프로필 편집 폼 입력값 관리
- **변경 감지**: 폼 데이터 변경 여부 실시간 감지
- **저장 상태**: 저장 진행 상태 및 결과 관리
- **상태 초기화**: 편집 취소 시 원래 상태로 복원

#### 5.5 모달 상태

- **프로필 모달**: 프로필 편집 모달 열림/닫힘 상태
- **모달 데이터**: 모달에 표시할 사용자 정보 관리

---

## 📋 6. 미디어 뷰어 (Media Viewer)

### 핵심 비즈니스 로직

#### 6.1 미디어 표시

- **이미지 뷰어**: 이미지 파일 전체 화면 표시
- **동영상 뷰어**: 동영상 파일 재생 및 제어
- **뷰어 컨텐츠**: 다양한 미디어 타입별 적절한 뷰어 제공

#### 6.2 미디어 유틸리티

- **파일 타입 감지**: 파일 확장자 및 MIME 타입 기반 미디어 타입 판별
- **썸네일 생성**: 미디어 파일의 썸네일 이미지 생성

---

## 📋 7. UI 상태 관리 (Global UI State)

### 핵심 비즈니스 로직

#### 7.1 모달 관리

- **모달 상태**: 다양한 모달의 열림/닫힘 상태 관리
- **모달 데이터**: 각 모달에 전달할 데이터 관리
- **모달 일괄 제어**: 모든 모달 한번에 닫기

#### 7.2 알림 다이얼로그

- **알림 메시지**: 사용자 알림 메시지 표시
- **확인/취소**: 사용자 확인이 필요한 액션 처리
- **자동 닫기**: 일정 시간 후 자동으로 닫히는 알림

---

## 📋 8. 공통 유틸리티 (Shared Utilities)

### 핵심 비즈니스 로직

#### 8.1 비동기 상태 관리

- **로딩 상태**: 비동기 작업의 로딩 상태 관리
- **에러 처리**: 비동기 작업 에러 상태 및 처리
- **성공 콜백**: 작업 성공 시 콜백 실행

#### 8.2 파일 업로드 유틸리티

- **파일 선택**: 파일 선택 다이얼로그 제어
- **업로드 진행**: 파일 업로드 진행 상태 관리
- **업로드 취소**: 진행 중인 업로드 취소 처리

#### 8.3 폼 입력 관리

- **입력 상태**: 폼 입력값 상태 관리
- **유효성 검사**: 입력값 실시간 유효성 검사
- **에러 표시**: 유효성 검사 결과 에러 메시지 표시

#### 8.4 반응형 처리

- **미디어 쿼리**: CSS 미디어 쿼리 상태 추적
- **모바일 감지**: 모바일 디바이스 여부 판단
- **화면 크기 대응**: 화면 크기별 UI 조정

---

## 📋 9. 설정 관리 (Settings)

### 비즈니스 로직 정의

#### 9.1 설정 메뉴 타입

- **계정 설정**: ACCOUNT - 개인 계정 관련 설정
- **친구 설정**: FRIEND - 친구 관련 설정
- **대화 설정**: TALK - 채팅 관련 설정
- **공지사항**: NOTICE - 앱 공지사항
- **고객센터**: CS - 고객지원 관련
- **정보**: INFOR - 앱 정보 및 약관

#### 9.2 대화 설정 타입

- **글자 크기**: TextWidth - 채팅 글자 크기 변경
- **배경 화면**: BackgroundColor - 채팅 배경 변경
- **백업**: Backup - 채팅 데이터 백업/복원

---

## 📋 10. 네비게이션 관리 (Navigation)

### 비즈니스 로직 정의

#### 10.1 메뉴 아이템 타입

- **친구**: FRIEND - 친구 목록 화면
- **나**: MY - 개인 프로필 화면
- **선물**: GIFT - 선물 관련 기능
- **채팅**: CHAT - 채팅 목록 화면
- **가족앨범**: FAMILY_ALBUM - 가족 사진 앨범
- **전체편집**: ALL_EDIT - 전체 편집 모드
- **없음**: NONE - 기본 상태

---

## 📋 11. 포인트 시스템 (Points)

### 비즈니스 로직 정의

#### 11.1 포인트 파일 카테고리

- **포인트**: POINT - 포인트 관련 파일 분류

#### 11.2 포인트 하위 카테고리

- **포인트 미션**: POINT_MISSIONS - 포인트 획득 미션 관련

---

## 📋 12. 웃음 기능 (Smile Me)

### 비즈니스 로직 정의

#### 12.1 웃음 파일 카테고리

- **웃음**: SMILE_ME - 웃음 관련 컨텐츠 분류

#### 12.2 웃음 하위 카테고리

- **웃음**: SMILE_ME - 웃음 관련 미디어 파일

---

## ✅ 비즈니스 로직 체크리스트

### 핵심 기능별 구현 완성도

✅ **인증 시스템**: 완전 구현 (로그인, 토큰 관리, 프로필 동기화)
✅ **친구 관리**: 완전 구현 (상태 관리, 요청/응답, 검색/필터링)  
✅ **실시간 채팅**: 완전 구현 (채널 관리, 파일 처리, 메시지 처리)
✅ **알림 시스템**: 완전 구현 (카테고리별 관리, 카운트 처리)
✅ **프로필 관리**: 완전 구현 (조회/수정, 이미지 처리, 폼 관리)
✅ **미디어 뷰어**: 완전 구현 (이미지/동영상 뷰어, 유틸리티)
✅ **UI 상태 관리**: 완전 구현 (모달, 알림 다이얼로그)
✅ **공통 유틸리티**: 완전 구현 (비동기 상태, 파일 업로드, 폼 관리)
🔶 **설정/네비게이션**: 부분 구현 (타입 정의만 완료, 실제 로직 미구현)
🔶 **포인트/웃음**: 부분 구현 (파일 분류 타입만 정의, 핵심 로직 미확인)

---

**총 분석된 비즈니스 로직 수**: 약 80개 이상의 구체적인 비즈니스 로직
**구현 완성도**: 핵심 기능 80% 완전 구현, 20% 부분 구현

이 분석을 통해 Ceragem Community는 대부분의 핵심 비즈니스 로직이 완전히 구현된 상태이며, 특히 인증, 친구관리, 채팅, 알림 시스템이 매우 체계적으로 구현되어 있음을 확인할 수 있습니다.
