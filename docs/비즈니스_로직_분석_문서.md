# Ceragem Community (FETA) ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë¶„ì„ ë¬¸ì„œ

## ğŸ“‹ í”„ë¡œì íŠ¸ ê°œìš”

**Ceragem Community Test (FETA)**ëŠ” Next.js 15ì™€ React 19 ê¸°ë°˜ìœ¼ë¡œ êµ¬ì¶•ëœ ì‹¤ì‹œê°„ ì»¤ë®¤ë‹ˆí‹° í”Œë«í¼ì…ë‹ˆë‹¤.

### í•µì‹¬ ê¸°ìˆ  ìŠ¤íƒ

- **Frontend**: Next.js 15 (App Router) + React 19 + TypeScript
- **State Management**: Zustand + TanStack Query
- **Real-time Chat**: Sendbird SDK
- **Authentication**: Firebase Auth
- **UI Framework**: Tailwind CSS + Radix UI
- **Architecture**: Feature Sliced Design (FSD)

---

## ğŸ—ï¸ ì•„í‚¤í…ì²˜ êµ¬ì¡° (Feature Sliced Design)

FSDëŠ” í”„ëŸ°íŠ¸ì—”ë“œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê³„ì¸µë³„ë¡œ êµ¬ì¡°í™”í•˜ëŠ” ì•„í‚¤í…ì²˜ íŒ¨í„´ì…ë‹ˆë‹¤.

### ë ˆì´ì–´ êµ¬ì¡° (ìƒìœ„ â†’ í•˜ìœ„)

```
src/
â”œâ”€â”€ app/                    # ì•± ì´ˆê¸°í™” ë° ì „ì—­ ì„¤ì •
â”œâ”€â”€ views/                  # í˜ì´ì§€ë³„ ë·° ì»´í¬ë„ŒíŠ¸ (FSD pages ë ˆì´ì–´)
â”œâ”€â”€ widgets/                # ë…ë¦½ì ì¸ ëŒ€í˜• UI ë¸”ë¡
â”œâ”€â”€ features/               # ë¹„ì¦ˆë‹ˆìŠ¤ ê¸°ëŠ¥ë³„ ëª¨ë“ˆ
â”œâ”€â”€ entities/               # ë„ë©”ì¸ ì—”í‹°í‹° ëª¨ë¸
â””â”€â”€ shared/                 # ê³µí†µ ìœ í‹¸ë¦¬í‹° ë° ë¼ì´ë¸ŒëŸ¬ë¦¬
```

### ì„¸ê·¸ë¨¼íŠ¸ êµ¬ì¡°

ê° ë ˆì´ì–´ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì„¸ê·¸ë¨¼íŠ¸ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤:

- `api/`: ë°±ì—”ë“œ í†µì‹  ë° ë°ì´í„° ë¡œì§
- `model/`: ë„ë©”ì¸ ëª¨ë¸, ìŠ¤í‚¤ë§ˆ, ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
- `ui/`: UI ì»´í¬ë„ŒíŠ¸ ë° ìŠ¤íƒ€ì¼
- `lib/`: í•´ë‹¹ ìŠ¬ë¼ì´ìŠ¤ì˜ ê³µí†µ ë¼ì´ë¸ŒëŸ¬ë¦¬
- `config/`: í™˜ê²½ ì„¤ì • ë° ê¸°ëŠ¥ í”Œë˜ê·¸

---

## ğŸ¯ ì£¼ìš” ë¹„ì¦ˆë‹ˆìŠ¤ ê¸°ëŠ¥ ë¶„ì„

### 1. ì¸ì¦ ì‹œìŠ¤í…œ (Authentication)

**ìœ„ì¹˜**: `src/features/auth/`

#### í•µì‹¬ ë¡œì§

- **í† í° ê¸°ë°˜ ì¸ì¦**: Access Token, Refresh Token, Session Token ê´€ë¦¬
- **ìë™ í† í° ê°±ì‹ **: í† í° ë§Œë£Œ ì‹œ ìë™ìœ¼ë¡œ ê°±ì‹  ì²˜ë¦¬
- **ì˜ì†ì  ìƒíƒœ ê´€ë¦¬**: localStorageë¥¼ í†µí•œ ë¡œê·¸ì¸ ìƒíƒœ ìœ ì§€

#### ì£¼ìš” íŒŒì¼

- `authStore.ts`: Zustand ê¸°ë°˜ ì¸ì¦ ìƒíƒœ ê´€ë¦¬
- `api/`: ë¡œê·¸ì¸, ë¡œê·¸ì•„ì›ƒ, í† í° ê°±ì‹  API
- `hooks/useAuth.ts`: ì¸ì¦ ìƒíƒœ í›…

#### ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§

```typescript
// 1. ë¡œê·¸ì¸ ì‹œ í† í° ì €ì¥ ë° ì‚¬ìš©ì ì •ë³´ ì—…ë°ì´íŠ¸
login: (authData) => {
  set({
    isAuthenticated: true,
    accessToken: authData.accessToken,
    refreshToken: authData.refreshToken,
    sessionToken: authData.sessionToken,
    userId: authData.sendBirdId,
    userProfile: authData.accountProfile,
  });
};

// 2. í† í° ê°±ì‹  ì‹œ ì¤‘ë³µ ìš”ì²­ ë°©ì§€
setTokenRefreshPromise: (promise) => {
  set({ tokenRefreshPromise: promise });
};
```

### 2. ì¹œêµ¬ ê´€ë¦¬ ì‹œìŠ¤í…œ (Friend Management)

**ìœ„ì¹˜**: `src/features/friend/`

#### í•µì‹¬ ë¡œì§

- **ì¹œêµ¬ ìƒíƒœ ê´€ë¦¬**: NORMAL, REQUEST, REQUESTED, BLOCK, HIDE, FAVORITE ë“±
- **ê·¸ë£¹ ê¸°ë°˜ ì¹œêµ¬ ê´€ë¦¬**: ì¹œêµ¬ë¥¼ ê·¸ë£¹ë³„ë¡œ ë¶„ë¥˜ ë° ê´€ë¦¬
- **ì‹¤ì‹œê°„ ìƒíƒœ ë™ê¸°í™”**: TanStack Queryë¥¼ í†µí•œ ìºì‹œ ë¬´íš¨í™”

#### ì£¼ìš” íŒŒì¼

- `api.ts`: ì¹œêµ¬ ê´€ë ¨ ëª¨ë“  API ìš”ì²­ í•¨ìˆ˜
- `api/dto-types.ts`: API ì‘ë‹µ ë°ì´í„° íƒ€ì…
- `api/contracts-types.ts`: ë„ë©”ì¸ ëª¨ë¸ íƒ€ì…
- `api/dto-mappers.ts`: DTO â†” Domain ë³€í™˜ í•¨ìˆ˜

#### ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§

```typescript
// ì¹œêµ¬ ëª©ë¡ ì¡°íšŒ (ìƒíƒœë³„ í•„í„°ë§)
export const useFriends = (params: FriendListParams) => {
  return useQuery({
    queryKey: ["user", "friends", params],
    queryFn: async () => getFriendListApi(params),
    enabled: params.friendType.length > 0,
  });
};

// ì¹œêµ¬ ì¦ê²¨ì°¾ê¸° í† ê¸€
export const useFriendFavorite = () => {
  return useMutation({
    mutationFn: async (data: { friendId: number; isFavorite: boolean }) => {
      const dtoResponse = await apiRequest(
        FRIEND_ENDPOINTS.PUT_FRIEND_FAVORITE,
        data
      );
      return mapFriendListResponse(dtoResponse);
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ["user"] });
    },
  });
};
```

### 3. ì‹¤ì‹œê°„ ì±„íŒ… ì‹œìŠ¤í…œ (Chat)

**ìœ„ì¹˜**: `src/features/chat/`

#### í•µì‹¬ ë¡œì§

- **Sendbird ê¸°ë°˜ ì‹¤ì‹œê°„ ì±„íŒ…**: ë©”ì‹œì§€ ì†¡ìˆ˜ì‹ , ì±„ë„ ê´€ë¦¬
- **íŒŒì¼ ì—…ë¡œë“œ ë° ê²€ìƒ‰**: ì´ë¯¸ì§€, ë™ì˜ìƒ ë“± ë¯¸ë””ì–´ íŒŒì¼ ê´€ë¦¬
- **ì±„ë„ íƒ€ì… ê´€ë¦¬**: GROUP, DIRECT, FAMILY, MY, ADMIN íƒ€ì…ë³„ ì²˜ë¦¬

#### ì£¼ìš” íŒŒì¼

- `api/createChannel.ts`: ì±„íŒ… ì±„ë„ ìƒì„±
- `api/fileSearchApi.ts`: íŒŒì¼ ê²€ìƒ‰ API
- `api/fileUploadApi.ts`: íŒŒì¼ ì—…ë¡œë“œ API
- `store.ts`: í˜„ì¬ ì±„ë„ ìƒíƒœ ê´€ë¦¬
- `hooks/`: ì±„íŒ… ê´€ë ¨ ì»¤ìŠ¤í…€ í›…ë“¤

#### ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§

```typescript
// ì±„ë„ ìƒì„± API
export const createChannel = async (
  params: CreateChannelRequest
): Promise<CreateChannelData> => {
  const dtoRequest: CreateChannelRequestDTO = {
    accountIds: params.accountIds,
    channelName: params.channelName,
    channelType: params.channelType,
  };

  const dtoResponse = await apiRequest<CreateChannelResponseDTO>(
    CHAT_ENDPOINTS.CREATE_CHANNEL,
    dtoRequest
  );

  return mapCreateChannelResponse(dtoResponse);
};

// íŒŒì¼ ì—…ë¡œë“œ API
export const uploadFile = async (
  params: FileUploadRequest
): Promise<FileUploadData> => {
  const formData = new FormData();
  formData.append("file", params.file);
  if (params.subCategory) formData.append("subCategory", params.subCategory);

  // íŒŒì¼ ì „ìš© axios ì¸ìŠ¤í„´ìŠ¤ ì‚¬ìš©
  const dtoResponse = await fileUploadInstance.post("/file/upload", formData);
  return mapFileUploadResponse(dtoResponse.data);
};
```

### 4. ì•Œë¦¼ ì‹œìŠ¤í…œ (Notifications)

**ìœ„ì¹˜**: `src/features/notifications/`

#### í•µì‹¬ ë¡œì§

- **ì¹´í…Œê³ ë¦¬ë³„ ì•Œë¦¼ ê´€ë¦¬**: FRIEND_REQUEST, CHAT, SYSTEM ë“±
- **ì½ìŒ/ì‚­ì œ ìƒíƒœ ê´€ë¦¬**: ì•Œë¦¼ ìƒíƒœ ë³€ê²½ ë° ì¹´ìš´íŠ¸ ê´€ë¦¬
- **ì‹¤ì‹œê°„ ì•Œë¦¼ ì—…ë°ì´íŠ¸**: Zustand ìŠ¤í† ì–´ë¥¼ í†µí•œ ìƒíƒœ ê´€ë¦¬

#### ì£¼ìš” íŒŒì¼

- `api.ts`: ì•Œë¦¼ ì¡°íšŒ, ì½ìŒ ì²˜ë¦¬, ì‚­ì œ API
- `model.ts`: ì•Œë¦¼ ë°ì´í„° ëª¨ë¸
- `store/useTotalNotificationStore.ts`: ì•Œë¦¼ ì¹´ìš´íŠ¸ ê´€ë¦¬

#### ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§

```typescript
// ì•Œë¦¼ ì½ìŒ ì²˜ë¦¬
export const useMarkNotiAsRead = () => {
  return useMutation({
    mutationFn: ({ notificationId }: { notificationId: string }) =>
      patchNotiApi(notificationId),
    onSuccess: (_, { category }) => {
      queryClient.invalidateQueries({ queryKey: ["notiList"] });

      // ì¹œêµ¬ ìš”ì²­ ì•Œë¦¼ì¸ ê²½ìš° ì¹´ìš´íŠ¸ ê°ì†Œ
      if (category === "FRIEND_REQUEST") {
        const { decreaseFriendRequestCount } =
          useTotalNotificationStore.getState();
        decreaseFriendRequestCount();
      }
    },
  });
};
```

### 5. í”„ë¡œí•„ ê´€ë¦¬ ì‹œìŠ¤í…œ (Profile)

**ìœ„ì¹˜**: `src/features/profile/`

#### í•µì‹¬ ë¡œì§

- **ì‚¬ìš©ì í”„ë¡œí•„ ì¡°íšŒ ë° ìˆ˜ì •**: ê°œì¸ì •ë³´, í”„ë¡œí•„ ì´ë¯¸ì§€ ê´€ë¦¬
- **Sendbird í”„ë¡œí•„ ì—°ë™**: ì±„íŒ…ìš© í”„ë¡œí•„ ì •ë³´ ë™ê¸°í™”
- **íŒŒì¼ ì—…ë¡œë“œ**: í”„ë¡œí•„ ì´ë¯¸ì§€ ì—…ë¡œë“œ ë° ì¸ë„¤ì¼ ìƒì„±

#### ì£¼ìš” íŒŒì¼

- `api.ts`: í”„ë¡œí•„ ì¡°íšŒ, ìˆ˜ì •, íŒŒì¼ ì—…ë¡œë“œ API
- `hooks/`: í”„ë¡œí•„ ê´€ë ¨ ì»¤ìŠ¤í…€ í›…ë“¤
- `ui/`: í”„ë¡œí•„ UI ì»´í¬ë„ŒíŠ¸ë“¤

---

## ğŸ”§ ê³µí†µ ì¸í”„ë¼ ë ˆì´ì–´ (Shared)

### API ê´€ë¦¬ (`src/shared/api/`)

#### í•µì‹¬ êµ¬ì¡°

- **axios.ts**: HTTP í´ë¼ì´ì–¸íŠ¸ ì„¤ì • ë° ì¸í„°ì…‰í„°
- **request.ts**: RESTful API ìš”ì²­ í•¨ìˆ˜ë“¤
- **endpoints.ts**: API ì—”ë“œí¬ì¸íŠ¸ ì •ì˜
- **model.ts**: ê³µí†µ API íƒ€ì… ì •ì˜

#### ì£¼ìš” ê¸°ëŠ¥

```typescript
// BFF(Backend For Frontend) íŒ¨í„´ìœ¼ë¡œ API í”„ë¡ì‹œ
export const apiRequest = <T = unknown>(
  endpoint: Endpoint,
  data?: unknown,
  params?: RequestParams,
  pathParams?: Record<string, string | number>
): Promise<T> => {
  const withPrefix = (url: string) => `/api/familytown${url}`;
  // ... ë©”ì„œë“œë³„ ë¼ìš°íŒ… ë¡œì§
};
```

### ê³µí†µ í›…ìŠ¤ (`src/shared/hooks/`)

- `useAsyncState.ts`: ë¹„ë™ê¸° ìƒíƒœ ê´€ë¦¬
- `useFileUpload.ts`: íŒŒì¼ ì—…ë¡œë“œ ìœ í‹¸ë¦¬í‹°
- `useMediaQuery.ts`: ë°˜ì‘í˜• ë””ìì¸ ì§€ì›
- `useMobileDevice.ts`: ëª¨ë°”ì¼ ë””ë°”ì´ìŠ¤ ê°ì§€

---

## ğŸ§© ì—”í‹°í‹° ë ˆì´ì–´ (Entities)

### ì£¼ìš” ë„ë©”ì¸ ëª¨ë¸

#### 1. Chat Entity (`src/entities/chat/`)

- ì±„íŒ… ë©”ì‹œì§€, ì±„ë„ ì •ë³´ ë“± ì±„íŒ… ê´€ë ¨ ê¸°ë³¸ íƒ€ì…

#### 2. Friend Entity (`src/entities/friend/`)

- ì¹œêµ¬ ê´€ê³„, ê·¸ë£¹ ì •ë³´ ë“± ì¹œêµ¬ ê´€ë ¨ ê¸°ë³¸ íƒ€ì…

#### 3. Profile Entity (`src/entities/profile/`)

- ì‚¬ìš©ì í”„ë¡œí•„, ê°œì¸ì •ë³´ ë“± í”„ë¡œí•„ ê´€ë ¨ ê¸°ë³¸ íƒ€ì…

---

## ğŸ¨ ìœ„ì ¯ ë ˆì´ì–´ (Widgets)

### ì£¼ìš” ìœ„ì ¯ë“¤

#### 1. ë ˆì´ì•„ì›ƒ (`src/widgets/layouts/`)

- `ProtectedLayout`: ì¸ì¦ì´ í•„ìš”í•œ í˜ì´ì§€ ë ˆì´ì•„ì›ƒ
- `DefaultLayout`: ê¸°ë³¸ í˜ì´ì§€ ë ˆì´ì•„ì›ƒ

#### 2. í”„ë¡œí•„ (`src/widgets/Profile/`)

- `ProfileViewer`: í”„ë¡œí•„ ìƒì„¸ ë³´ê¸°
- `ProfileCard`: í”„ë¡œí•„ ì¹´ë“œ ì»´í¬ë„ŒíŠ¸
- `ProfileAvatar`: í”„ë¡œí•„ ì•„ë°”íƒ€ (ê°œì¸/ê·¸ë£¹)

#### 3. ì¹œêµ¬ ê°œìš” (`src/widgets/FriendsOverview/`)

- `FriendsOverview`: ì¹œêµ¬ ëª©ë¡ ë©”ì¸ í™”ë©´
- `FriendsList`: ì¹œêµ¬ ëª©ë¡ ì»´í¬ë„ŒíŠ¸

#### 4. ì•Œë¦¼ (`src/widgets/Notifications/`)

- `NotificationList`: ì•Œë¦¼ ëª©ë¡
- `NotificationCard`: ê°œë³„ ì•Œë¦¼ ì¹´ë“œ

---

## ğŸ”„ ë°ì´í„° í”Œë¡œìš°

### 1. API ìš”ì²­ í”Œë¡œìš°

```
Component â†’ Feature Hook â†’ API Function â†’ Shared Request â†’ Backend
                â†“
Component â† DTO Mapper â† API Response â† Shared Request â† Backend
```

### 2. ìƒíƒœ ê´€ë¦¬ í”Œë¡œìš°

```
User Action â†’ Component â†’ Feature Hook â†’ Zustand Store â†’ Component Re-render
                                    â†“
                                TanStack Query Cache â†’ Component Re-render
```

### 3. ì¸ì¦ í”Œë¡œìš°

```
Login â†’ Auth API â†’ Token Storage â†’ Middleware Check â†’ Protected Route Access
```

---

## ğŸ”’ ë³´ì•ˆ ë° ì¸ì¦

### ë¯¸ë“¤ì›¨ì–´ (`middleware.ts`)

- **í† í° ê²€ì¦**: í—¤ë”ì™€ ì¿ í‚¤ì˜ í† í° ì¼ì¹˜ì„± í™•ì¸
- **ìë™ ë¦¬ë‹¤ì´ë ‰íŠ¸**: ì¸ì¦ ì‹¤íŒ¨ ì‹œ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™
- **JWT í† í° ê´€ë¦¬**: Access/Refresh í† í° ìë™ ê°±ì‹ 

### í† í° ê´€ë¦¬ ì „ëµ

1. **ë‹¤ì¤‘ í† í° ì‹œìŠ¤í…œ**: Access, Refresh, Session í† í°
2. **ìë™ ê°±ì‹ **: í† í° ë§Œë£Œ ì „ ìë™ ê°±ì‹  ë¡œì§
3. **ì¤‘ë³µ ë°©ì§€**: ë™ì‹œ ê°±ì‹  ìš”ì²­ ë°©ì§€ë¥¼ ìœ„í•œ Promise ìºì‹±

---

## ğŸ“Š ìƒíƒœ ê´€ë¦¬ íŒ¨í„´

### 1. Zustand (ì „ì—­ ìƒíƒœ)

- ì¸ì¦ ìƒíƒœ (`authStore.ts`)
- ì±„ë„ ìƒíƒœ (`chat/store.ts`)
- ì•Œë¦¼ ì¹´ìš´íŠ¸ (`notifications/store/`)

### 2. TanStack Query (ì„œë²„ ìƒíƒœ)

- API ë°ì´í„° ìºì‹± ë° ë™ê¸°í™”
- ë°±ê·¸ë¼ìš´ë“œ ìë™ ì¬ìš”ì²­
- ë‚™ê´€ì  ì—…ë°ì´íŠ¸

---

## ğŸ” ê°œë°œ ë„êµ¬ ë° ì»¨ë²¤ì…˜

### ì•„í‚¤í…ì²˜ ë¦°íŒ…

```bash
npm run lint:arch        # Steigerë¥¼ í†µí•œ FSD ê·œì¹™ ê²€ì¦
```

### ì½”ë“œ ìƒì„±

```bash
npm run gen:fsd          # FSD êµ¬ì¡°ì— ë§ëŠ” ìŠ¬ë¼ì´ìŠ¤ ìë™ ìƒì„±
```

### í”„ë¡œì íŠ¸ ì»¨ë²¤ì…˜

- **íƒ€ì… ì•ˆì „ì„±**: TypeScriptë¥¼ í†µí•œ ê°•ë ¥í•œ íƒ€ì… ì²´í¬
- **DTO íŒ¨í„´**: API ì‘ë‹µê³¼ ë„ë©”ì¸ ëª¨ë¸ ë¶„ë¦¬
- **ëª¨ë“ˆ ê²½ê³„**: ê° ë ˆì´ì–´ ê°„ ì˜ì¡´ì„± ê·œì¹™ ì¤€ìˆ˜

---

## ğŸ“ˆ ì„±ëŠ¥ ìµœì í™”

### 1. ì½”ë“œ ë¶„í• 

- Next.js App Routerì˜ ìë™ ì½”ë“œ ë¶„í• 
- ì»´í¬ë„ŒíŠ¸ë³„ lazy loading

### 2. ìºì‹± ì „ëµ

- TanStack Queryì˜ ì§€ëŠ¥ì  ìºì‹±
- ì´ë¯¸ì§€ ë° ì •ì  ìì‚° ìºì‹±

### 3. ë²ˆë“¤ ìµœì í™”

- Turbopackì„ í†µí•œ ë¹ ë¥¸ ê°œë°œ ë¹Œë“œ
- Tree shakingì„ í†µí•œ ë¶ˆí•„ìš”í•œ ì½”ë“œ ì œê±°

---

ì´ ë¬¸ì„œëŠ” Ceragem Community (FETA) í”„ë¡œì íŠ¸ì˜ ì „ë°˜ì ì¸ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ê³¼ ì•„í‚¤í…ì²˜ë¥¼ ë¶„ì„í•œ ê²°ê³¼ì…ë‹ˆë‹¤. ê° ë ˆì´ì–´ì™€ ê¸°ëŠ¥ë³„ë¡œ ëª…í™•í•œ ì—­í•  ë¶„ë‹´ê³¼ ë°ì´í„° í”Œë¡œìš°ë¥¼ í†µí•´ ìœ ì§€ë³´ìˆ˜ ê°€ëŠ¥í•˜ê³  í™•ì¥ ê°€ëŠ¥í•œ êµ¬ì¡°ë¥¼ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.
